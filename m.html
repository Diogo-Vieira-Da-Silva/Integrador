<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bem-vindo</title>

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <style>
        body {
            background: linear-gradient(to right, #0d6efd 20%, white 20%, white 80%, #0d6efd 80%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .title {
            font-size: 3rem;
            font-weight: 700;
            color: #212529;
            font-family: "Segoe UI", Arial, sans-serif;
        }

        /* botão com mesma fonte do h1 */
        .btn-custom {
            font-size: 3rem;
            font-weight: 700;
            font-family: "Segoe UI", Arial, sans-serif;
            padding: 0.5rem 1.5rem;
        }

        /* fixa o botão ao fundo */
        .footer-btn {
            margin-top: auto;
            padding-bottom: 40px; /* espaço do fundo */
        }
    </style>
</head>
<body>

    <div class="container text-center mt-5">

        <div class="text-center mb-4">
            <button onclick="showInicio()" class="btn btn-primary btn-custom">Início</button>
            <button onclick="showPacientes()" class="btn btn-primary btn-custom">Pacientes</button>
            <button onclick="showPendingHistories()" class="btn btn-primary btn-custom">Alertas Pendentes</button>
            <button onclick="showPulseira()" class="btn btn-primary btn-custom">Pulseira</button>
        </div>

        <h1 class="title mb-4" id="welcomeMessage">Bem vindo(a)</h1>

        <!-- NOVO: área de conteúdo limitada a 900px de largura -->
        <div style="max-width: 900px; margin: 0 auto;">

            <div id="contentArea">
                <img src="sensecare.jpg" class="img-fluid mb-4" style="max-width: 300px;">
            </div>

        </div>

    </div>

    <!-- botão no fundo da página -->
    <div id="footerBtn" class="footer-btn text-center">
        <button onclick="logout()" class="btn btn-primary btn-custom">
            Sair
        </button>
    </div>

    <script>
        const saved = JSON.parse(localStorage.getItem('currentUser'));
        if (saved && saved.nome) {
            document.getElementById('welcomeMessage').textContent = 'Bem vindo(a) ' + saved.nome;
        }

        function logout() {
            localStorage.removeItem('passwordVisible');
            window.location.href = 'index.html';
        }

        function showInicio() {
            document.getElementById('welcomeMessage').style.display = 'block';
            document.getElementById('contentArea').innerHTML = '<img src="sensecare.jpg" class="img-fluid mb-4" style="max-width: 300px;">';
            document.getElementById('footerBtn').style.display = 'block';
        }

        function showPacientes() {
            document.getElementById('welcomeMessage').style.display = 'none';
            let html = '<h1 class="title mb-4">Pacientes</h1><button class="btn btn-primary btn-custom" data-bs-toggle="modal" data-bs-target="#addPatientModal">Adicionar Pacientes</button><h2 class="title mb-4">Lista de Pacientes</h2>';
            const patients = JSON.parse(localStorage.getItem('patients')) || [];
            patients.forEach((patient, index) => {
                html += `
                    <div class="text-center mb-5">
                        <div class="d-flex justify-content-center align-items-center mb-2">
                            <button onclick="showCare(${index})" class="btn btn-info btn-custom me-2">Cuidado</button>
                            <button onclick="showPatientDetails(${index})" class="btn btn-outline-primary btn-custom me-2">${patient.primeiroNome} ${patient.sobrenome}</button>
                            <button onclick="deletePatient(${index})" class="btn btn-danger btn-custom">Deletar</button>
                        </div>
                        <button onclick="showCareHistory(${index})" class="btn btn-warning btn-custom">Histórico</button>
                    </div>
                `;
            });
            document.getElementById('contentArea').innerHTML = html;
            document.getElementById('footerBtn').style.display = 'none';
        }

        function showPatientDetails(index) {
            const patients = JSON.parse(localStorage.getItem('patients')) || [];
            const patient = patients[index];
            document.getElementById('contentArea').innerHTML = `
                <h1 class="title mb-4">${patient.primeiroNome} ${patient.sobrenome}</h1>
                <p><strong>Data de Nascimento:</strong> ${patient.dataNascimento}</p>
                <p><strong>CPF:</strong> ${patient.cpf}</p>
                <p><strong>Endereço:</strong> ${patient.endereco}</p>
                <p><strong>Telefone:</strong> ${patient.telefone}</p>
                <p><strong>Nome do Responsável:</strong> ${patient.nomeResponsavel || 'N/A'}</p>
                <p><strong>Telefone do Responsável:</strong> ${patient.telefoneResponsavel || 'N/A'}</p>
                <p><strong>Procedimento:</strong> ${patient.procedimento}</p>
                <p><strong>Histórico de Doenças:</strong> ${patient.historicoDoencas || 'N/A'}</p>
                <p><strong>Medicações:</strong> ${patient.medicacoes || 'N/A'}</p>
                <p><strong>Sexo:</strong> ${patient.sexo}</p>
                <p><strong>Prioridade:</strong> ${patient.prioridade}</p>
                <p><strong>Risco:</strong> ${patient.risco}</p>
                <p><strong>Alergias:</strong> ${patient.alergias || 'N/A'}</p>
                <p><strong>Especificações:</strong> ${patient.especificacoes || 'N/A'}</p>
                <button onclick="showPacientes()" class="btn btn-secondary btn-custom">Voltar</button>
            `;
        }

        function deletePatient(index) {
            if (confirm('Tem certeza que deseja deletar este paciente?')) {
                let patients = JSON.parse(localStorage.getItem('patients')) || [];
                patients.splice(index, 1);
                localStorage.setItem('patients', JSON.stringify(patients));
                showPacientes();
            }
        }

        function showCare(index) {
            const patients = JSON.parse(localStorage.getItem('patients')) || [];
            const patient = patients[index];
            document.getElementById('contentArea').innerHTML = `
                <h1 class="title mb-4">Cuidados para ${patient.primeiroNome} ${patient.sobrenome}</h1>
                <form id="careForm" onsubmit="saveCare(event, ${index})">
                    <div class="mb-3">
                        <label>Tipos de Cuidado:</label><br>
                        <input type="checkbox" id="medicacao" name="cuidado" value="Medicação"> Medicação<br>
                        <input type="checkbox" id="banhoLeito" name="cuidado" value="Banho de Leito"> Banho de Leito<br>
                        <input type="checkbox" id="hidratacao" name="cuidado" value="Hidratação"> Hidratação<br>
                        <input type="checkbox" id="mudancaDecubito" name="cuidado" value="Mudança de Decúbito"> Mudança de Decúbito<br>
                        <input type="checkbox" id="outro" name="cuidado" value="Outro"> Outro<br>
                    </div>
                    <div class="mb-3">
                        <label for="observacoes">Observações:</label>
                        <textarea class="form-control" id="observacoes" rows="3"></textarea>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="dataCuidado">Data do Cuidado:</label>
                            <input type="date" class="form-control" id="dataCuidado" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="horarioCuidado">Horário:</label>
                            <input type="time" class="form-control" id="horarioCuidado" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary btn-custom">Salvar Cuidado</button>
                    <button type="button" onclick="showPacientes()" class="btn btn-secondary btn-custom ms-2">Voltar</button>
                </form>
            `;
        }

        function saveCare(event, index) {
            event.preventDefault();
            const cuidados = Array.from(document.querySelectorAll('input[name="cuidado"]:checked')).map(cb => cb.value);
            const observacoes = document.getElementById('observacoes').value;
            const dataCuidado = document.getElementById('dataCuidado').value;
            const horarioCuidado = document.getElementById('horarioCuidado').value;
            const care = {
                cuidados: cuidados,
                observacoes: observacoes,
                data: dataCuidado,
                horario: horarioCuidado,
                status: "Pendente"
            };
            let patients = JSON.parse(localStorage.getItem('patients')) || [];
            if (!patients[index].cares) patients[index].cares = [];
            patients[index].cares.push(care);
            localStorage.setItem('patients', JSON.stringify(patients));
            alert('Cuidado salvo com sucesso!');
            showPacientes();
        }

        function showPendingHistories() {
            let patients = JSON.parse(localStorage.getItem('patients')) || [];
            let updated = false;
            patients.forEach(patient => {
                if (patient.cares) {
                    patient.cares.forEach(care => {
                        if (!care.status) {
                            care.status = "Pendente";
                            updated = true;
                        }
                    });
                }
            });
            if (updated) {
                localStorage.setItem('patients', JSON.stringify(patients));
            }
            let historyHtml = '<h1 class="title mb-4">Cuidados Pendentes</h1>';
            let hasCares = false;
            patients.forEach((patient, pIndex) => {
                if (patient.cares && patient.cares.length > 0) {
                    historyHtml += `<h3>${patient.primeiroNome} ${patient.sobrenome}</h3>`;
                    patient.cares.forEach((care, cIndex) => {
                        const statusClass = care.status === "Concluído" ? "text-success" : "text-danger";
                        historyHtml += `
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h5 class="card-title">Cuidado - ${care.data} ${care.horario}</h5>
                                    <p><strong>Tipos:</strong> ${care.cuidados.join(', ')}</p>
                                    <p><strong>Observações:</strong> ${care.observacoes || 'Nenhuma'}</p>
                                    <div class="d-flex align-items-center">
                                        <input type="checkbox" onchange="toggleStatus(${pIndex}, ${cIndex})" ${care.status === "Concluído" ? "checked" : ""} class="me-2">
                                        <span id="status-${pIndex}-${cIndex}" class="${statusClass}">${care.status}</span>
                                    </div>
                                </div>
                            </div>
                        `;
                        hasCares = true;
                    });
                }
            });
            if (!hasCares) {
                historyHtml += '<p>Nenhum cuidado registrado ainda.</p>';
            }
            historyHtml += '<button onclick="showInicio()" class="btn btn-secondary btn-custom">Voltar</button>';
            document.getElementById('welcomeMessage').style.display = 'none';
            document.getElementById('contentArea').innerHTML = historyHtml;
            document.getElementById('footerBtn').style.display = 'none';
        }

        function toggleStatus(pIndex, cIndex) {
            let patients = JSON.parse(localStorage.getItem('patients')) || [];
            const care = patients[pIndex].cares[cIndex];
            care.status = care.status === "Pendente" ? "Concluído" : "Pendente";
            localStorage.setItem('patients', JSON.stringify(patients));
            const span = document.getElementById(`status-${pIndex}-${cIndex}`);
            span.textContent = care.status;
            span.className = care.status === "Concluído" ? "text-success" : "text-danger";
        }

        function showCareHistory(index) {
            const patients = JSON.parse(localStorage.getItem('patients')) || [];
            const patient = patients[index];
            let historyHtml = `<h1 class="title mb-4">Histórico de Cuidados para ${patient.primeiroNome} ${patient.sobrenome}</h1>`;
            if (patient.cares && patient.cares.length > 0) {
                patient.cares.forEach((care, i) => {
                    historyHtml += `
                        <div class="card mb-3">
                            <div class="card-body">
                                <h5 class="card-title">Cuidado ${i + 1} - ${care.data} ${care.horario}</h5>
                                <p><strong>Tipos:</strong> ${care.cuidados.join(', ')}</p>
                                <p><strong>Observações:</strong> ${care.observacoes || 'Nenhuma'}</p>
                            </div>
                        </div>
                    `;
                });
            } else {
                historyHtml += '<p>Nenhum cuidado registrado ainda.</p>';
            }
            historyHtml += '<button onclick="showPacientes()" class="btn btn-secondary btn-custom">Voltar</button>';
            document.getElementById('contentArea').innerHTML = historyHtml;
        }

        function showPulseira() {
            document.getElementById('welcomeMessage').style.display = 'none';
            document.getElementById('contentArea').innerHTML = '<button onclick="showAlertas()" class="btn btn-primary btn-custom">Conectar</button>';
            document.getElementById('footerBtn').style.display = 'none';
        }

        function addPatient() {
            const form = document.getElementById('addPatientForm');
            if (!form.checkValidity()) {
                alert('Por favor, preencha todos os campos obrigatórios.');
                return;
            }
            const patient = {
                primeiroNome: document.getElementById('primeiroNome').value,
                sobrenome: document.getElementById('sobrenome').value,
                dataNascimento: document.getElementById('dataNascimento').value,
                cpf: document.getElementById('cpf').value,
                endereco: document.getElementById('endereco').value,
                telefone: document.getElementById('telefone').value,
                nomeResponsavel: document.getElementById('nomeResponsavel').value,
                telefoneResponsavel: document.getElementById('telefoneResponsavel').value,
                procedimento: document.getElementById('procedimento').value,
                historicoDoencas: document.getElementById('historicoDoencas').value,
                medicacoes: document.getElementById('medicacoes').value,
                sexo: document.getElementById('sexo').value,
                prioridade: document.getElementById('prioridade').value,
                risco: document.getElementById('risco').value,
                alergias: document.getElementById('alergias').value,
                especificacoes: document.getElementById('especificacoes').value
            };
            let patients = JSON.parse(localStorage.getItem('patients')) || [];
            patients.push(patient);
            localStorage.setItem('patients', JSON.stringify(patients));
            form.reset();
            const modal = bootstrap.Modal.getInstance(document.getElementById('addPatientModal'));
            modal.hide();
            showPacientes(); // refresh the list
        }

        function showAlertas() {
            document.getElementById('contentArea').innerHTML = `
                <div class="d-flex flex-column align-items-center justify-content-between" style="min-height: 300px;">
                    <div>
                        <button class="btn btn-danger btn-custom">Alertas</button>
                        <p class="mt-3 small text-center">
                            Descompensação Extrema: Pressão arterial ou temperatura em níveis perigosamente altos ou baixos (Ex: hipotensão severa, febre alta > 39.5°C). Estes picos podem indicar complicações como Choque Séptico, Acidente Vascular Cerebral (AVC) ou Infarto Agudo do Miocárdio.<br>
                            Parâmetros de Risco de Vida: Detecção de arritmia cardíaca grave, dessaturação de oxigênio (hipóxia) ou ausência de pulso.<br>
                            Sintomas Graves: Perda de consciência, convulsões, hemorragia visível ou dificuldade respiratória súbita e intensa.<br>
                            Ação do Médico: Prioridade máxima. Intervenção de emergência e, se necessário, acionamento imediato da equipe de ressuscitação.
                        </p>
                    </div>

                    <div>
                        <button class="btn btn-warning btn-custom">Alertas</button>
                        <p class="mt-3 small text-center">
                            Sinais Vitais Limítrofes: Pressão arterial ou temperatura subindo ou caindo, mas ainda dentro de uma margem que exige monitoramento a cada 15-30 minutos 
                            (Ex: temperatura atingindo 37.8°C ou Pressão Sistólica próxima de 145 mmHg).<br>
                            Cuidados Atrasados: Atraso significativo (> 30 minutos) na administração de um medicamento vital ou na execução de um cuidado importante, como a troca de decúbito, aumentando o risco de complicações (como úlceras por pressão).<br>
                            Sintomas Leves/Moderados: Paciente relata dor crescente (moderada), náuseas ou confusão mental leve.<br>
                            Ação do Médico: Prioridade média. Requer atenção imediata para avaliação e estabilização, antes que evolua para o alerta Vermelho.
                        </p>
                    </div>

                    <div>
                        <div class="d-flex align-items-center justify-content-center">
                            <button class="btn btn-success btn-custom me-3">Alertas</button>
                        </div>
                        <p class="mt-3 small text-center">
                            Conforto Básico: O paciente acionou a chamada para solicitar água, ajuste no travesseiro, troca de posição (sem indicação clínica obrigatória) ou assistência para mudar o canal da TV.<br>
                            Rotina: Lembrete de verificação de rotina ou medicamento de baixa criticidade agendado para o futuro próximo.<br>
                            Parâmetros Estáveis: Sinais vitais (Frequência Cardíaca, Pressão, Temperatura) totalmente dentro das margens seguras estabelecidas pelo médico.<br>
                            Ação do Médico: Prioridade baixa. Atendimento pode ser encaixado na rotina sem interromper cuidados mais urgentes.
                        </p>
                        <button onclick="showPulseira()" class="btn btn-secondary btn-custom mt-3">Desconectar</button>
                    </div>
                </div>
            `;
        }
    </script>

    <!-- Modal Adicionar Paciente -->
    <div class="modal fade" id="addPatientModal" tabindex="-1" aria-labelledby="addPatientModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addPatientModalLabel">Adicionar Paciente</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addPatientForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label>Primeiro Nome:</label>
                                <input type="text" class="form-control" id="primeiroNome" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label>Sobrenome:</label>
                                <input type="text" class="form-control" id="sobrenome" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label>Data de Nascimento:</label>
                                <input type="date" class="form-control" id="dataNascimento" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label>CPF:</label>
                                <input type="text" class="form-control" id="cpf" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label>Endereço:</label>
                            <input type="text" class="form-control" id="endereco" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label>Telefone:</label>
                                <input type="text" class="form-control" id="telefone" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label>Nome do(a) Responsável:</label>
                                <input type="text" class="form-control" id="nomeResponsavel">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label>Telefone do(a) Responsável:</label>
                            <input type="text" class="form-control" id="telefoneResponsavel">
                        </div>
                        <div class="mb-3">
                            <label>Procedimento:</label>
                            <input type="text" class="form-control" id="procedimento" required>
                        </div>
                        <div class="mb-3">
                            <label>Histórico de Doenças:</label>
                            <textarea class="form-control" id="historicoDoencas" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label>Medicações:</label>
                            <textarea class="form-control" id="medicacoes" rows="3"></textarea>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label>Sexo:</label>
                                <select class="form-control" id="sexo" required>
                                    <option value="">Selecione</option>
                                    <option value="masculino">Masculino</option>
                                    <option value="feminino">Feminino</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label>Prioridade de Atendimento:</label>
                                <select class="form-control" id="prioridade" required>
                                    <option value="">Selecione</option>
                                    <option value="alta">Neurodivergente</option>
                                    <option value="media">Gestante</option>
                                    <option value="baixa">Nenhuma</option>
                                </select>
                            </div>
                             <div class="col-md-6 mb-3">
                                <label>Risco:</label>
                                <select class="form-control" id="risco" required>
                                    <option value="">Selecione</option>
                                    <option value="idoso">60 anos ou mais</option>
                                    <option value="nada">Nenhuma</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label>Alergias:</label>
                            <textarea class="form-control" id="alergias" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label>Especificações:</label>
                            <textarea class="form-control" id="especificacoes" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="addPatient()">Adicionar</button>
                </div>
            </div>
        </div>
    </div>

</body>
</html>

